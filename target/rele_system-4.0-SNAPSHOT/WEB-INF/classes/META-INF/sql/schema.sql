DROP TABLE IF EXISTS RELAY;
DROP TABLE IF EXISTS STATIV;
DROP TABLE IF EXISTS STATION;
DROP TABLE IF EXISTS AUTHORITIES;
DROP TABLE IF EXISTS USER;
DROP TABLE IF EXISTS LOG;



CREATE TABLE STATION
(
    ID INT AUTO_INCREMENT PRIMARY KEY NOT NULL,
    VERSION INT DEFAULT 0 NOT NULL,
    STATION_NAME VARCHAR(20) NOT NULL
);


CREATE TABLE STATIV
(
    ID INT AUTO_INCREMENT PRIMARY KEY NOT NULL,
    VERSION INT DEFAULT 0 NOT NULL,
    NUM INT NOT NULL,
    STATION_ID INT NOT NULL,
    CONSTRAINT FK_STATION_IN_STATIV FOREIGN KEY (STATION_ID) REFERENCES STATION (ID) ON UPDATE CASCADE ON DELETE CASCADE

);



CREATE TABLE RELAY
(
    ID INT AUTO_INCREMENT NOT NULL,
    VERSION INT DEFAULT 0 NOT NULL,
    STATIV_ID INT ,
    SERIAL_NUMBER INT NOT NULL,
    TYPE_ID VARCHAR(10) NOT NULL,
    SHELVE_POSITION INT,
    SERVICE_DATE DATE,
    NEXT_SERVICE_DATE DATE,
    MANUFACTURE_DATE DATE,
    RESPONSIBLE_PERSON VARCHAR(40) NOT NULL,
    CONSTRAINT FK_STATIV_IN_RELE FOREIGN KEY (STATIV_ID) REFERENCES STATIV (ID) ON UPDATE CASCADE ON DELETE CASCADE

        , PRIMARY KEY (ID)
);

CREATE UNIQUE INDEX UQ_RELAY_1_INDEX_4 ON RELAY (SERIAL_NUMBER);

--USER TABLE
CREATE TABLE USER (
    IDUSER INT DEFAULT 0 NOT NULL,
    USERNAME VARCHAR(255) NOT NULL ,
    PASSWORD  VARCHAR(255) NOT NULL,
    ENABLED BOOLEAN NOT NULL,
     PRIMARY KEY(USERNAME)
);

--AUTHORITIES TABLE
CREATE TABLE AUTHORITIES(
      USERNAME VARCHAR(255) NOT NULL,
      AUTHORITY VARCHAR(255) NOT NULL,
      CONSTRAINT FK_AUTHORITIES_USER FOREIGN KEY(USERNAME) REFERENCES USER(USERNAME));
;

--LOG TABLE
CREATE TABLE LOG (
	IDLOG INT AUTO_INCREMENT NOT NULL,
    LOGSTRING VARCHAR(1000) NULL,
    PRIMARY KEY (IDLOG)
);

--TEST TABLE
CREATE TABLE IF NOT EXISTS TEST (
	IDTEST INT AUTO_INCREMENT NOT NULL,
    TESTCOLUMN VARCHAR(1000) NULL,
    PRIMARY KEY (IDTEST)
);









